setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플/data")
setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플")
rm(list=ls())
setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플/data")
getwd()
setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플/data")
rm(list=ls())
setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플/data")
getwd()
rm(list=ls())
setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플/data")
conv_dat = read.table(file="data/convenience_store.txt", sep='\t', header=TRUE)
conv_dat = data.frame(Region=conv_dat[,1],id=conv_dat[,2],StoreNum=conv_dat[,7],Population=conv_dat[,8],Worker=conv_dat[,9])
trust_dat = read.table(file="data/social_trust.txt", sep='\t', header=TRUE)
crime_dat = read.table(file="data/crime_2019.txt", sep='\t', header=TRUE)
raped_dat = read.table(file="data/raped.txt", sep='\t', header=TRUE)
rapedT_dat = read.table(file="data/raped_total.txt", sep='\t', header=TRUE)
population = conv_dat$Population + conv_dat$Worker/1.3
conv_dat[,3:3] = conv_dat[,3:3] / population
crime_dat[,3:14] = crime_dat[,3:14] / population
raped_dat[,2:16] = raped_dat[,2:16] / population
conv_dat[,3:3] = scale(conv_dat[,3:3])
trust_dat[,3:9] = scale(trust_dat[,3:9])
crime_dat[,3:14] = scale(crime_dat[,3:14])
raped_dat[,2:16] = scale(raped_dat[,2:16])
rm(list=ls())
setwd("C:/Users/milim/OneDrive - kaist.ac.kr/2020F/R을 활용한 빅데이터 분석 기초/팀플/CS564-teamproject")
getwd()
conv_dat = read.table(file="data/convenience_store.txt", sep='\t', header=TRUE)
conv_dat = data.frame(Region=conv_dat[,1],id=conv_dat[,2],StoreNum=conv_dat[,7],Population=conv_dat[,8],Worker=conv_dat[,9])
trust_dat = read.table(file="data/social_trust.txt", sep='\t', header=TRUE)
crime_dat = read.table(file="data/crime_2019.txt", sep='\t', header=TRUE)
raped_dat = read.table(file="data/raped.txt", sep='\t', header=TRUE)
rapedT_dat = read.table(file="data/raped_total.txt", sep='\t', header=TRUE)
population = conv_dat$Population + conv_dat$Worker/1.3
conv_dat[,3:3] = conv_dat[,3:3] / population
crime_dat[,3:14] = crime_dat[,3:14] / population
raped_dat[,2:16] = raped_dat[,2:16] / population
conv_dat[,3:3] = scale(conv_dat[,3:3])
trust_dat[,3:9] = scale(trust_dat[,3:9])
crime_dat[,3:14] = scale(crime_dat[,3:14])
raped_dat[,2:16] = scale(raped_dat[,2:16])
crime_dat = crime_dat[,c(1,2,4,6,8,10,12,14)]
trust_map = merge(seoul, cbind(trust_dat, conv_dat[,3]), by='id')
library(raster)
library(ggplot2)
library(dplyr)
korea = shapefile('map/TL_SCCO_SIG.shp')
korea = fortify(korea, region='SIG_CD')
seoul = korea[korea$id <= 11740, ]
gu_name = read.table(file="data/gu_name.txt", sep='\t', header=TRUE)
trust_map = merge(seoul, cbind(trust_dat, conv_dat[,3]), by='id')
crime_map = merge(seoul, cbind(crime_dat, conv_dat[,3]), by='id')
colnames(crime_map)[15] = "Store"
ggplot() + geom_polygon(data=crime_map, aes(x=long, y=lat, group=group, fill=Store*Total), color='gray40') +
scale_fill_gradient2(low = "#FF0000", high = "#0081FF") +
labs(fill = "종합 범죄 발생 건수") +
coord_fixed(ratio = 1.3) +
ggtitle("범죄 발생 건수") +
geom_text(data =gu_name, aes(x = long, y = lat, label = Region))
ggplot() + geom_polygon(data=crime_map, aes(x=long, y=lat, group=group, fill=Store*TotalR), color='gray40') +
scale_fill_gradient2(low = "#FF0000", high = "#0081FF") +
labs(fill = "종합 범죄 발생 건수") +
coord_fixed(ratio = 1.3) +
ggtitle("범죄 발생 건수") +
geom_text(data =gu_name, aes(x = long, y = lat, label = Region))
ggplot() + geom_polygon(data=crime_map, aes(x=long, y=lat, group=group, fill=Store*TotalR), color='gray40') +
scale_fill_gradient2(low = "#FF0000", high = "#0081FF") +
labs(fill = "종합 범죄 발생 검거율") +
coord_fixed(ratio = 1.3) +
ggtitle("범죄 발생 검거율") +
geom_text(data =gu_name, aes(x = long, y = lat, label = Region))
crime_cor = cbind(conv_dat[,3], crime_dat[,3:8])
colnames(crime_cor)[1] = "Store"
chart.Correlation(crime_cor)
library(PerformanceAnalytics)
chart.Correlation(crime_cor)
crime_cor = cor(crime_cor)
crime_cor2 = as.data.frame(crime_cor[1, 2:13])
colnames(crime_cor2)[1] = "Corr"
crime_cor2 = as.data.frame(crime_cor[1, 2:7])
colnames(crime_cor2)[1] = "Corr"
corrplot(crime_cor, method="number")
library(corrplot)
corrplot(trust_cor, method="number")
corrplot(crime_cor, method="number")
ggplot(crime_cor2, aes(x=rownames(crime_cor2), y=Corr)) +
geom_bar(stat="identity", position="dodge", fill='#0081FF') +
coord_cartesian(ylim = c(-0.2:0.9)) +
ggtitle("범죄 발생 상관 관계") +
theme_bw()
